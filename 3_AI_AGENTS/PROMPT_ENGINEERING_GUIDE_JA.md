# プロンプトエンジニアリングガイド

## プロンプトエンジニアリングのベストプラクティス

### 構造と明確さ

```
効果的なプロンプト構造：

1. ロール定義
   - AIの役割と専門性を明確に定義
   - 振る舞いや能力の期待値を明示
   - コンテキストとドメインを設定

2. タスク内容
   - 実施すべき内容を具体的に記載
   - 複雑なタスクはステップに分解
   - 成功基準を明示

3. 入力仕様
   - 入力フォーマット・構造を定義
   - 必須情報と任意情報を明確化
   - イレギュラーや欠損データへの対応も明示

4. 出力形式
   - 望ましい出力構造（JSON、テキスト等）を指定
   - 必須フィールドとデータ型を定義
   - 期待する出力例を提示

5. 制約・ガイドライン
   - 振る舞い上の制限や禁止事項を明確に
   - 避けるべき内容・表現を指定
   - 品質・安全基準を記載
```

### 例示とFew-Shot Learning

```
例パターン：

システム：あなたは求人要件アナライザーです。求人投稿のコンプライアンスを確認してください。

ユーザー：「30歳未満・英語ネイティブ希望」

AI：
- 指摘事項：年齢差別
- 推奨：法的根拠がない場合は年齢制限を削除
- 出力：コンプライアンス上のリスクを構造化JSONで一覧化
```

### イテレーティブリファインメント

* AIの出力を下書きとし、ユーザー実例やフィードバックで随時プロンプトを改善
* 出力は必ず明確性、正確性、偏り、コンプライアンスで検証

### 言語とトーン

* 常にプロフェッショナルかつ簡潔・親切な文体を使用
* ユーザー役割（候補者、企業、管理者など）でトーンを調整
* 専門外の方でも分かる平易な日本語を心がける

---

## 高度なプロンプトエンジニアリング手法

### Chain-of-Thoughtプロンプト

```
システム：あらゆる判断において、最終回答の前に逐次的な理由を説明してください。
```

### マルチターン文脈保持

* 各ターンで主要な文脈を繰り返し明示し、誤解や幻覚を防ぐ
* 変数（例：{CANDIDATE\_PROFILE}）を用いてワークフロー全体で文脈を引き継ぐ

### ロール切り替え

* シナリオごとにプロンプトの役割を明確に切替（履歴書パーサー、コンプライアンス判定、キャリアコーチ、面接官等）
* エージェント間の出力連携時はメタプロンプトを使って切替を明示

### バイアス対策

* 各ステップで明示的なバイアスチェックをリクエスト
* 公平性・法令順守・インクルーシブ対応のチェックリスト活用

---

## プロンプトバージョン管理

* すべてのシステム/専門プロンプトに変更履歴を残す
* 主要変更は本番前にステージング環境で検証
* 規制や業務プロセスの変更に応じて定期的にプロンプトを見直し

---

## トラブルシューティング・エラーハンドリング

* エージェント信頼度が低い場合は「確信が持てません。人間のアドバイザーに相談しますか？」などのフォールバックを利用
* ユーザーのフィードバックをログ化しプロンプト改善に活用

---

## サンプルプロンプトテンプレート

### 求人マッチング（ヘルスケア・IT・BPO等）

```
あなたは{INDUSTRY}分野の求人マッチングエージェントです。下記求人内容と候補者プロフィールを比較評価してください。

- 必須の技術スキル・資格・語学力を照合
- ソフトスキルと職歴を評価
- 市場・法的要件（例：日本の看護師免許など）も考慮

出力：
- マッチスコア（0～100）
- 解説
- スキルギャップ
- 推奨事項
```

### コンプライアンス判定エージェント

```
あなたは{COUNTRY}市場の求人・契約書コンプライアンス判定AIです。リスクを指摘し、適法な代替案を提案してください。
```

### 面接コーチ

```
あなたは{ROLE}向けのバーチャル面接コーチです。模擬質問を生成し、ユーザー回答をレビュー、建設的なフィードバックを提供します。
```

---

## 参考資料

* [iWORKZコンプライアンスAIプロンプト](../COMPLIANCE/COMPLIANCE_AI_PROMPTS.md)
* [iWORKZビジネス文脈](../DOCUMENTATION/BUSINESS_CONTEXT.md)
